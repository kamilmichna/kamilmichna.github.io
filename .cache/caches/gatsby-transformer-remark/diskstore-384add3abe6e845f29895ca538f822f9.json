{"expireTime":9007200826686518000,"key":"transformer-remark-markdown-html-0c4025a0b174aefc2d9e5febfb358a77-gatsby-remark-prismjs-","val":"<h1>Koa - pliki statyczne.</h1>\n<h2>W dzisiejszym tutorialu odkryjemy, jak sprawić aby nasz serwer hostował pliki statyczne takie jak zdjęcia lub pliki kaskadowych arkuszów styli.</h2>\n<p>Za przykład weźmiemy sobie znany nam z poprzednich postów plik <strong>index.pug</strong>:</p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\"><span class=\"token tag\">html</span>\n    <span class=\"token tag\">head</span>\n        <span class=\"token tag\">title</span><span class=\"token punctuation\">=</span><span class=\"token code\">title</span>\n    <span class=\"token tag\">body</span>\n        <span class=\"token tag\">h1</span><span class=\"token punctuation\">=</span><span class=\"token code\">content</span></code></pre></div>\n<p>Zmodyfikujmy także nasz plik <strong>router.js</strong> - póki co nie hostuje on naszego pliku <strong>index.pug</strong>. Zamieńmy więc to:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> Router <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'koa-router'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> router <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Router</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> views <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'koa-views'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\nrouter\n    <span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">ctx</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">await</span> ctx<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"forms.pug\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/sendData'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">ctx</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`WARTOŚĆ POLA TEKSTOWEGO: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>ctx<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>content<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> router</code></pre></div>\n<p>na to:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> Router <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'koa-router'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> router <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Router</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n\nrouter\n    <span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">ctx</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">await</span> ctx<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"index.pug\"</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span>content<span class=\"token punctuation\">:</span><span class=\"token string\">\"hello\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    \n\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> router</code></pre></div>\n<p>Teraz nasza strona dostępna jest pod adresem <strong><a href=\"http://localhost:3000/\">http://localhost:3000/</a></strong>. </p>\n<h2>Dodawanie arkuszy styli do strony.</h2>\n<p>Stwórzmy sobie zatem katalog <strong>public</strong> w naszym projekcie. Niech znajduje się on w jego katalogu głównym. Będzie nam służył jako miejsce w którym zgromadzimy wszystkie pliki statyczne - takie jak <strong>arkusze styli, strony w czystym html czy zdjęcia</strong>.</p>\n<p>Struktura naszego projektu powinna teraz wyglądać tak:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">- node_modules\n- views\n    - index.pug\n- public\n- main.js\n- package.json\n- package.lock.json\n- router.js</code></pre></div>\n<p>W katalogu <strong>public</strong> utwórzmy sobie podkatalog <strong>styles</strong> (który będzie zawierał pliki css naszego projektu) a w nim prosty plik <strong>style.css</strong> który będzie zawierał bardzo prostą regułę - cały tekst na stronie ma być czerwony. Tak naprawdę jest kompletnie obojętne jakie reguły css zdefiniujemy wewnątrz pliku, ale w ten sposób będziemy mogli łatwo sprawdzić czy wszystko działa tak jak powinno</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">*</span><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">color</span><span class=\"token punctuation\">:</span>red<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>A w ten sposób podłączymy sobie nasz plik css do pliku index.pug:</p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\"><span class=\"token tag\">html</span>\n    <span class=\"token tag\">head</span>\n        <span class=\"token tag\">title</span><span class=\"token punctuation\">=</span><span class=\"token code\">title</span>\n        <span class=\"token tag\">link<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">rel</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">\"stylesheet\"</span></span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">href</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">\"./styles/style.css\"</span></span><span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token tag\">body</span>\n        <span class=\"token tag\">h1</span><span class=\"token punctuation\">=</span><span class=\"token code\">content</span></code></pre></div>\n<p>Jak jednak łatwo zauważyć, kolor czcionki na naszej stronie nie zmienia się. <strong>Musimy więc tak skonfigurować nasz serwer, aby przy zapytaniu o jakikolwiek plki statyczny szukał go w katalogu public</strong>.</p>\n<h2>Jak to osiągnąć?</h2>\n<p>Przyda nam się do tego kolejny middleware o wiele mówiącej nazwie <strong>koa-static</strong>. Zainstalujemy go poleceniem <code class=\"language-text\">npm install koa-static</code>.</p>\n<h2>Dodawanie middleware do aplikacji</h2>\n<p>Po pomyślnej instalacji musimy dodać odrobinę kodu do naszego pliku <strong>main.js</strong>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> Koa <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"koa\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Koa</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> router <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./router'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> views <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'koa-views'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> bodyparser <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'koa-bodyparser'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> serve <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'koa-static'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//#1</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token function\">serve</span><span class=\"token punctuation\">(</span>__dirname <span class=\"token operator\">+</span> <span class=\"token string\">'/public/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token comment\">//#2</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token function\">bodyparser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token function\">views</span><span class=\"token punctuation\">(</span>__dirname <span class=\"token operator\">+</span> <span class=\"token string\">'/views'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    map<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        extension<span class=\"token punctuation\">:</span> <span class=\"token string\">'pug'</span> \n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>router<span class=\"token punctuation\">.</span><span class=\"token function\">routes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token number\">3000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    </code></pre></div>\n<p><strong>#1</strong> to import zainstalowanej przez nas wcześniej biblioteki, a <strong>#2</strong> to definicja użycia <strong>koa-static</strong> w naszej aplikacji. Podajemy tam jako argument absolutną ścieżkę (a więc poprzedzoną <code class=\"language-text\">__dirname</code>) do naszego katalogu public, co pozwoli nam uzyskać dostęp do zawartych tam plików.</p>\n<h2>Zdjęcia</h2>\n<p>Jak zatem dodać zdjęcie? W folderze public stwórzmy sobie katalog <strong>images</strong> a do niego dodajmy zdjęcie o nazwie, na przykład <strong>image.jpg</strong>. Następnie aby dodać je w naszym pliku <strong>index.pug</strong> musimy dodać w sekcji body następującą linie:</p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\"><span class=\"token tag\">img<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">src</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">\"./images/image.jpg\"</span></span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">alt</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">\"alternatywny tekst dla obrazka\"</span></span><span class=\"token punctuation\">)</span></span></span></code></pre></div>\n<p>A więc teraz plik będzie wyglądał tak: </p>\n<div class=\"gatsby-highlight\" data-language=\"pug\"><pre class=\"language-pug\"><code class=\"language-pug\"><span class=\"token tag\">html</span>\n    <span class=\"token tag\">head</span>\n        <span class=\"token tag\">title</span><span class=\"token punctuation\">=</span><span class=\"token code\">title</span>\n        <span class=\"token tag\">link<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">rel</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">\"stylesheet\"</span></span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">href</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">\"./styles/style.css\"</span></span><span class=\"token punctuation\">)</span></span></span>\n    <span class=\"token tag\">body</span>\n        <span class=\"token tag\">h1</span><span class=\"token punctuation\">=</span><span class=\"token code\">content</span>\n        <span class=\"token tag\">img<span class=\"token attributes\"><span class=\"token punctuation\">(</span><span class=\"token attr-name\">src</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">\"./images/image.jpg\"</span></span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">alt</span><span class=\"token punctuation\">=</span><span class=\"token attr-value\"><span class=\"token string\">\"alternatywny tekst dla obrazka\"</span></span><span class=\"token punctuation\">)</span></span></span></code></pre></div>\n<h3>Dzięki za uwagę, Kamil Michna ;)</h3>"}